
  0%|                                                                  | 0/2 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
511
1076
1587
tensor(2.0538, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2058
tensor(1.4695, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2058
tensor(2.0155, device='cuda:0', grad_fn=<DivBackward0>)
511
1033
1544
tensor(2.0987, device='cuda:0', grad_fn=<DivBackward0>)
 50%|█████████████████████████████                             | 1/2 [00:05<00:05,  5.21s/it]
511
1482
1993
tensor(2.1217, device='cuda:0', grad_fn=<DivBackward0>)
511
761
1272
tensor(1.8649, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2058
tensor(2.2621, device='cuda:0', grad_fn=<DivBackward0>)
511
1547

100%|██████████████████████████████████████████████████████████| 2/2 [00:10<00:00,  5.02s/it]

100%|██████████████████████████████████████████████████████████| 2/2 [01:02<00:00, 31.32s/it]
{'train_runtime': 66.6911, 'train_samples_per_second': 0.48, 'train_steps_per_second': 0.03, 'train_loss': 1.9308267831802368, 'epoch': 0.0}
Traceback (most recent call last):
  File "/home/jingbo/KVMemory/finetune_connect.py", line 93, in <module>
    main()
  File "/home/jingbo/KVMemory/finetune_connect.py", line 87, in main
    torch.save(custom_model.state_dict().trainable_key_caches, dump_dir + "/trainable_key_caches.pth")
AttributeError: 'collections.OrderedDict' object has no attribute 'trainable_key_caches'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/jingbo/KVMemory/finetune_connect.py", line 93, in <module>
[rank0]:     main()
[rank0]:   File "/home/jingbo/KVMemory/finetune_connect.py", line 87, in main
[rank0]:     torch.save(custom_model.state_dict().trainable_key_caches, dump_dir + "/trainable_key_caches.pth")
[rank0]: AttributeError: 'collections.OrderedDict' object has no attribute 'trainable_key_caches'