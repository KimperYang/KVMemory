
  0%|                                                                                                                                                                                                    | 0/30000 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)




  0%|                                                                                                                                                                                         | 5/30000 [00:28<46:47:07,  5.62s/it]




  0%|                                                                                                                                                                                         | 9/30000 [00:52<48:20:57,  5.80s/it]






  0%|                                                                                                                                                                                        | 15/30000 [01:28<50:33:37,  6.07s/it]





  0%|                                                                                                                                                                                        | 20/30000 [01:57<48:13:15,  5.79s/it]




  0%|▏                                                                                                                                                                                       | 24/30000 [02:20<48:22:52,  5.81s/it]






  0%|▏                                                                                                                                                                                       | 30/30000 [02:54<47:28:02,  5.70s/it]





  0%|▏                                                                                                                                                                                       | 35/30000 [03:24<48:23:25,  5.81s/it]





  0%|▏                                                                                                                                                                                       | 40/30000 [03:53<48:45:45,  5.86s/it]





  0%|▎                                                                                                                                                                                       | 45/30000 [04:23<50:29:56,  6.07s/it]





  0%|▎                                                                                                                                                                                       | 50/30000 [04:52<48:53:00,  5.88s/it]




  0%|▎                                                                                                                                                                                       | 54/30000 [05:16<49:27:57,  5.95s/it]






  0%|▎                                                                                                                                                                                       | 60/30000 [05:51<47:32:35,  5.72s/it]




  0%|▍                                                                                                                                                                                       | 64/30000 [06:14<47:30:20,  5.71s/it]





  0%|▍                                                                                                                                                                                       | 69/30000 [06:44<49:52:46,  6.00s/it]






  0%|▍                                                                                                                                                                                       | 75/30000 [07:19<48:47:48,  5.87s/it]





  0%|▍                                                                                                                                                                                       | 80/30000 [07:47<47:33:46,  5.72s/it]




  0%|▌                                                                                                                                                                                       | 84/30000 [08:11<47:36:23,  5.73s/it]





  0%|▌                                                                                                                                                                                       | 89/30000 [08:40<48:50:17,  5.88s/it]





  0%|▌                                                                                                                                                                                       | 94/30000 [09:08<47:13:14,  5.68s/it]





  0%|▌                                                                                                                                                                                       | 99/30000 [09:37<48:14:51,  5.81s/it]





  0%|▋                                                                                                                                                                                      | 104/30000 [10:12<53:41:19,  6.47s/it]






  0%|▋                                                                                                                                                                                      | 110/30000 [10:47<47:52:22,  5.77s/it]





  0%|▋                                                                                                                                                                                      | 115/30000 [11:19<52:20:37,  6.31s/it]





  0%|▋                                                                                                                                                                                      | 120/30000 [11:48<48:50:47,  5.89s/it]





  0%|▊                                                                                                                                                                                      | 125/30000 [12:17<49:43:30,  5.99s/it]





  0%|▊                                                                                                                                                                                      | 130/30000 [12:47<48:53:25,  5.89s/it]




  0%|▊                                                                                                                                                                                      | 134/30000 [13:11<48:47:19,  5.88s/it]





  0%|▊                                                                                                                                                                                      | 139/30000 [13:41<49:23:32,  5.95s/it]





  0%|▉                                                                                                                                                                                      | 144/30000 [14:09<46:23:59,  5.59s/it]






  0%|▉                                                                                                                                                                                      | 150/30000 [14:46<49:06:21,  5.92s/it]




  1%|▉                                                                                                                                                                                      | 154/30000 [15:09<48:35:17,  5.86s/it]






  1%|▉                                                                                                                                                                                      | 160/30000 [15:44<48:21:46,  5.83s/it]




  1%|█                                                                                                                                                                                      | 164/30000 [16:07<48:38:40,  5.87s/it]






  1%|█                                                                                                                                                                                      | 170/30000 [16:56<61:52:54,  7.47s/it]




  1%|█                                                                                                                                                                                      | 174/30000 [17:19<52:25:18,  6.33s/it]






  1%|█                                                                                                                                                                                      | 180/30000 [17:54<49:34:18,  5.98s/it]




  1%|█                                                                                                                                                                                      | 184/30000 [18:28<65:10:24,  7.87s/it]






  1%|█▏                                                                                                                                                                                     | 190/30000 [19:06<51:48:15,  6.26s/it]




  1%|█▏                                                                                                                                                                                     | 194/30000 [19:30<49:25:43,  5.97s/it]





  1%|█▏                                                                                                                                                                                     | 199/30000 [19:59<47:01:22,  5.68s/it]






  1%|█▎                                                                                                                                                                                     | 205/30000 [20:40<50:23:33,  6.09s/it]





  1%|█▎                                                                                                                                                                                     | 210/30000 [21:10<50:02:36,  6.05s/it]





  1%|█▎                                                                                                                                                                                     | 215/30000 [21:54<70:21:34,  8.50s/it]




  1%|█▎                                                                                                                                                                                     | 219/30000 [22:21<57:00:52,  6.89s/it]






  1%|█▎                                                                                                                                                                                     | 225/30000 [22:55<46:18:46,  5.60s/it]





  1%|█▍                                                                                                                                                                                     | 230/30000 [23:24<48:35:14,  5.88s/it]




  1%|█▍                                                                                                                                                                                     | 234/30000 [23:48<50:18:15,  6.08s/it]






  1%|█▍                                                                                                                                                                                     | 240/30000 [24:24<50:11:11,  6.07s/it]




  1%|█▍                                                                                                                                                                                     | 244/30000 [24:47<48:02:48,  5.81s/it]





  1%|█▌                                                                                                                                                                                     | 249/30000 [25:17<49:15:58,  5.96s/it]






  1%|█▌                                                                                                                                                                                     | 255/30000 [25:52<46:39:43,  5.65s/it]




  1%|█▌                                                                                                                                                                                     | 259/30000 [26:18<51:55:56,  6.29s/it]





  1%|█▌                                                                                                                                                                                     | 264/30000 [26:46<47:37:59,  5.77s/it]





  1%|█▋                                                                                                                                                                                     | 269/30000 [27:16<48:41:58,  5.90s/it]






  1%|█▋                                                                                                                                                                                     | 275/30000 [27:51<48:21:06,  5.86s/it]





  1%|█▋                                                                                                                                                                                     | 280/30000 [28:19<47:03:30,  5.70s/it]




  1%|█▋                                                                                                                                                                                     | 284/30000 [28:42<46:53:21,  5.68s/it]





  1%|█▊                                                                                                                                                                                     | 289/30000 [29:10<45:57:06,  5.57s/it]






  1%|█▊                                                                                                                                                                                     | 295/30000 [29:43<45:16:07,  5.49s/it]




  1%|█▊                                                                                                                                                                                     | 299/30000 [30:06<47:05:36,  5.71s/it]






  1%|█▊                                                                                                                                                                                     | 305/30000 [30:48<53:19:03,  6.46s/it]





  1%|█▉                                                                                                                                                                                     | 310/30000 [31:17<48:40:13,  5.90s/it]




  1%|█▉                                                                                                                                                                                     | 314/30000 [31:42<49:41:29,  6.03s/it]






  1%|█▉                                                                                                                                                                                     | 320/30000 [32:15<46:06:54,  5.59s/it]





  1%|█▉                                                                                                                                                                                     | 325/30000 [32:46<48:29:03,  5.88s/it]





  1%|██                                                                                                                                                                                     | 330/30000 [33:15<49:00:15,  5.95s/it]




  1%|██                                                                                                                                                                                     | 334/30000 [33:39<48:46:49,  5.92s/it]





  1%|██                                                                                                                                                                                     | 339/30000 [34:09<49:22:02,  5.99s/it]






  1%|██                                                                                                                                                                                     | 345/30000 [34:43<47:42:12,  5.79s/it]





  1%|██▏                                                                                                                                                                                    | 350/30000 [35:13<48:06:27,  5.84s/it]





  1%|██▏                                                                                                                                                                                    | 355/30000 [35:43<49:53:17,  6.06s/it]





  1%|██▏                                                                                                                                                                                    | 360/30000 [36:11<46:37:58,  5.66s/it]





  1%|██▏                                                                                                                                                                                    | 365/30000 [36:40<48:20:06,  5.87s/it]




  1%|██▎                                                                                                                                                                                    | 369/30000 [37:02<46:16:24,  5.62s/it]






  1%|██▎                                                                                                                                                                                    | 375/30000 [37:38<47:33:42,  5.78s/it]





  1%|██▎                                                                                                                                                                                    | 380/30000 [38:07<48:09:47,  5.85s/it]





  1%|██▎                                                                                                                                                                                    | 385/30000 [38:36<47:18:56,  5.75s/it]





  1%|██▍                                                                                                                                                                                    | 390/30000 [39:06<48:40:36,  5.92s/it]





  1%|██▍                                                                                                                                                                                    | 395/30000 [39:35<48:21:32,  5.88s/it]




  1%|██▍                                                                                                                                                                                    | 399/30000 [39:59<48:33:43,  5.91s/it]





  1%|██▍                                                                                                                                                                                    | 404/30000 [40:35<53:37:24,  6.52s/it]





  1%|██▍                                                                                                                                                                                    | 409/30000 [41:03<48:10:34,  5.86s/it]






  1%|██▌                                                                                                                                                                                    | 415/30000 [41:38<46:55:35,  5.71s/it]





  1%|██▌                                                                                                                                                                                    | 420/30000 [42:07<46:53:01,  5.71s/it]




  1%|██▌                                                                                                                                                                                    | 424/30000 [42:28<44:31:32,  5.42s/it]





  1%|██▌                                                                                                                                                                                    | 429/30000 [42:57<46:49:17,  5.70s/it]






  1%|██▋                                                                                                                                                                                    | 435/30000 [43:32<47:39:18,  5.80s/it]





  1%|██▋                                                                                                                                                                                    | 440/30000 [44:00<46:40:32,  5.68s/it]




  1%|██▋                                                                                                                                                                                    | 444/30000 [44:23<45:19:49,  5.52s/it]





  1%|██▋                                                                                                                                                                                    | 449/30000 [44:53<48:40:25,  5.93s/it]






  2%|██▊                                                                                                                                                                                    | 455/30000 [45:29<48:59:40,  5.97s/it]




  2%|██▊                                                                                                                                                                                    | 459/30000 [45:53<50:09:15,  6.11s/it]





  2%|██▊                                                                                                                                                                                    | 464/30000 [46:23<49:37:45,  6.05s/it]






  2%|██▊                                                                                                                                                                                    | 470/30000 [46:57<46:51:11,  5.71s/it]




  2%|██▉                                                                                                                                                                                    | 474/30000 [47:21<48:01:50,  5.86s/it]





  2%|██▉                                                                                                                                                                                    | 479/30000 [47:51<48:44:32,  5.94s/it]





  2%|██▉                                                                                                                                                                                    | 484/30000 [48:21<49:52:13,  6.08s/it]






  2%|██▉                                                                                                                                                                                    | 490/30000 [48:58<49:53:46,  6.09s/it]




  2%|███                                                                                                                                                                                    | 494/30000 [49:21<47:51:02,  5.84s/it]






  2%|███                                                                                                                                                                                    | 500/30000 [49:56<48:10:58,  5.88s/it]





  2%|███                                                                                                                                                                                    | 505/30000 [50:32<51:53:41,  6.33s/it]





  2%|███                                                                                                                                                                                    | 510/30000 [51:02<49:29:41,  6.04s/it]





  2%|███▏                                                                                                                                                                                   | 515/30000 [51:33<49:03:43,  5.99s/it]





  2%|███▏                                                                                                                                                                                   | 520/30000 [52:02<47:59:13,  5.86s/it]





  2%|███▏                                                                                                                                                                                   | 525/30000 [52:32<48:14:17,  5.89s/it]





  2%|███▏                                                                                                                                                                                   | 530/30000 [53:06<56:39:52,  6.92s/it]





  2%|███▎                                                                                                                                                                                   | 535/30000 [53:45<62:54:24,  7.69s/it]





  2%|███▎                                                                                                                                                                                   | 540/30000 [54:23<62:59:33,  7.70s/it]





  2%|███▎                                                                                                                                                                                   | 545/30000 [55:01<61:46:05,  7.55s/it]





  2%|███▎                                                                                                                                                                                   | 550/30000 [55:39<62:38:38,  7.66s/it]





  2%|███▍                                                                                                                                                                                   | 555/30000 [56:18<63:44:20,  7.79s/it]





  2%|███▍                                                                                                                                                                                   | 560/30000 [56:56<61:50:38,  7.56s/it]





  2%|███▍                                                                                                                                                                                   | 565/30000 [57:32<59:48:11,  7.31s/it]





  2%|███▍                                                                                                                                                                                   | 570/30000 [58:11<61:05:54,  7.47s/it]





  2%|███▌                                                                                                                                                                                   | 575/30000 [58:48<61:21:04,  7.51s/it]





  2%|███▌                                                                                                                                                                                   | 580/30000 [59:27<63:42:43,  7.80s/it]




  2%|███▌                                                                                                                                                                                   | 584/30000 [59:58<65:37:02,  8.03s/it]






  2%|███▌                                                                                                                                                                                 | 590/30000 [1:00:42<61:11:00,  7.49s/it]





  2%|███▌                                                                                                                                                                                 | 595/30000 [1:01:21<63:17:10,  7.75s/it]





  2%|███▌                                                                                                                                                                                 | 600/30000 [1:01:58<58:56:09,  7.22s/it]





  2%|███▋                                                                                                                                                                                 | 605/30000 [1:02:41<65:09:14,  7.98s/it]





  2%|███▋                                                                                                                                                                                 | 610/30000 [1:03:19<62:34:00,  7.66s/it]





  2%|███▋                                                                                                                                                                                 | 615/30000 [1:03:59<64:34:37,  7.91s/it]





  2%|███▋                                                                                                                                                                                 | 620/30000 [1:04:38<64:34:44,  7.91s/it]





  2%|███▊                                                                                                                                                                                 | 625/30000 [1:05:09<51:20:54,  6.29s/it]




  2%|███▊                                                                                                                                                                                 | 629/30000 [1:05:32<47:34:06,  5.83s/it]






  2%|███▊                                                                                                                                                                                 | 635/30000 [1:06:08<46:32:28,  5.71s/it]





  2%|███▊                                                                                                                                                                                 | 640/30000 [1:06:37<48:37:20,  5.96s/it]





  2%|███▉                                                                                                                                                                                 | 645/30000 [1:07:05<45:28:58,  5.58s/it]





  2%|███▉                                                                                                                                                                                 | 650/30000 [1:07:34<46:38:55,  5.72s/it]





  2%|███▉                                                                                                                                                                                 | 655/30000 [1:08:03<46:32:48,  5.71s/it]





  2%|███▉                                                                                                                                                                                 | 660/30000 [1:08:32<46:29:38,  5.70s/it]




  2%|████                                                                                                                                                                                 | 664/30000 [1:08:55<47:06:31,  5.78s/it]






  2%|████                                                                                                                                                                                 | 670/30000 [1:09:31<47:38:53,  5.85s/it]





  2%|████                                                                                                                                                                                 | 675/30000 [1:09:59<46:46:01,  5.74s/it]





  2%|████                                                                                                                                                                                 | 680/30000 [1:10:29<48:42:51,  5.98s/it]





  2%|████▏                                                                                                                                                                                | 685/30000 [1:10:58<48:03:14,  5.90s/it]




  2%|████▏                                                                                                                                                                                | 689/30000 [1:11:22<47:32:34,  5.84s/it]






  2%|████▏                                                                                                                                                                                | 695/30000 [1:11:58<48:28:51,  5.96s/it]





  2%|████▏                                                                                                                                                                                | 700/30000 [1:12:28<49:41:19,  6.11s/it]





  2%|████▎                                                                                                                                                                                | 705/30000 [1:13:03<51:03:09,  6.27s/it]





  2%|████▎                                                                                                                                                                                | 710/30000 [1:13:32<47:15:43,  5.81s/it]





  2%|████▎                                                                                                                                                                                | 715/30000 [1:14:02<48:23:06,  5.95s/it]





  2%|████▎                                                                                                                                                                                | 720/30000 [1:14:32<48:31:35,  5.97s/it]





  2%|████▎                                                                                                                                                                                | 725/30000 [1:15:03<48:36:21,  5.98s/it]





  2%|████▍                                                                                                                                                                                | 730/30000 [1:15:32<46:09:32,  5.68s/it]





  2%|████▍                                                                                                                                                                                | 735/30000 [1:16:02<48:52:00,  6.01s/it]





  2%|████▍                                                                                                                                                                                | 740/30000 [1:16:33<50:42:07,  6.24s/it]





  2%|████▍                                                                                                                                                                                | 745/30000 [1:17:02<46:21:36,  5.70s/it]




  2%|████▌                                                                                                                                                                                | 749/30000 [1:17:25<47:08:40,  5.80s/it]






  3%|████▌                                                                                                                                                                                | 755/30000 [1:18:01<46:40:04,  5.74s/it]





  3%|████▌                                                                                                                                                                                | 760/30000 [1:18:30<48:07:17,  5.92s/it]





  3%|████▌                                                                                                                                                                                | 765/30000 [1:19:00<47:45:28,  5.88s/it]





  3%|████▋                                                                                                                                                                                | 770/30000 [1:19:30<48:26:24,  5.97s/it]





  3%|████▋                                                                                                                                                                                | 775/30000 [1:20:00<48:38:01,  5.99s/it]





  3%|████▋                                                                                                                                                                                | 780/30000 [1:20:28<47:02:39,  5.80s/it]





  3%|████▋                                                                                                                                                                                | 785/30000 [1:20:59<48:30:08,  5.98s/it]





  3%|████▊                                                                                                                                                                                | 790/30000 [1:21:29<48:47:22,  6.01s/it]





  3%|████▊                                                                                                                                                                                | 795/30000 [1:21:57<47:56:07,  5.91s/it]





  3%|████▊                                                                                                                                                                                | 800/30000 [1:22:28<49:22:49,  6.09s/it]





  3%|████▊                                                                                                                                                                                | 805/30000 [1:23:04<51:29:26,  6.35s/it]





  3%|████▉                                                                                                                                                                                | 810/30000 [1:23:33<48:58:22,  6.04s/it]





  3%|████▉                                                                                                                                                                                | 815/30000 [1:24:04<48:01:07,  5.92s/it]





  3%|████▉                                                                                                                                                                                | 820/30000 [1:24:33<48:06:43,  5.94s/it]





  3%|████▉                                                                                                                                                                                | 825/30000 [1:25:02<47:53:33,  5.91s/it]





  3%|█████                                                                                                                                                                                | 830/30000 [1:25:31<46:34:06,  5.75s/it]





  3%|█████                                                                                                                                                                                | 835/30000 [1:26:01<48:06:31,  5.94s/it]





  3%|█████                                                                                                                                                                                | 840/30000 [1:26:31<49:23:38,  6.10s/it]





  3%|█████                                                                                                                                                                                | 845/30000 [1:27:02<49:13:48,  6.08s/it]





  3%|█████▏                                                                                                                                                                               | 850/30000 [1:27:33<49:11:02,  6.07s/it]





  3%|█████▏                                                                                                                                                                               | 855/30000 [1:28:02<48:08:04,  5.95s/it]





  3%|█████▏                                                                                                                                                                               | 860/30000 [1:28:32<48:07:10,  5.94s/it]





  3%|█████▏                                                                                                                                                                               | 865/30000 [1:29:03<49:40:47,  6.14s/it]





  3%|█████▏                                                                                                                                                                               | 870/30000 [1:29:32<46:59:31,  5.81s/it]





  3%|█████▎                                                                                                                                                                               | 875/30000 [1:30:01<48:01:35,  5.94s/it]





  3%|█████▎                                                                                                                                                                               | 880/30000 [1:30:31<48:45:36,  6.03s/it]





  3%|█████▎                                                                                                                                                                               | 885/30000 [1:31:01<49:17:05,  6.09s/it]





  3%|█████▎                                                                                                                                                                               | 890/30000 [1:31:31<48:01:29,  5.94s/it]





  3%|█████▍                                                                                                                                                                               | 895/30000 [1:32:01<48:50:31,  6.04s/it]





  3%|█████▍                                                                                                                                                                               | 900/30000 [1:32:31<48:57:09,  6.06s/it]





  3%|█████▍                                                                                                                                                                               | 905/30000 [1:33:07<51:45:27,  6.40s/it]





  3%|█████▍                                                                                                                                                                               | 910/30000 [1:33:38<49:06:29,  6.08s/it]





  3%|█████▌                                                                                                                                                                               | 915/30000 [1:34:07<48:34:00,  6.01s/it]





  3%|█████▌                                                                                                                                                                               | 920/30000 [1:34:36<47:09:17,  5.84s/it]





  3%|█████▌                                                                                                                                                                               | 925/30000 [1:35:07<48:36:39,  6.02s/it]





  3%|█████▌                                                                                                                                                                               | 930/30000 [1:35:37<48:51:52,  6.05s/it]





  3%|█████▋                                                                                                                                                                               | 935/30000 [1:36:06<46:57:26,  5.82s/it]





  3%|█████▋                                                                                                                                                                               | 940/30000 [1:36:35<47:42:58,  5.91s/it]





  3%|█████▋                                                                                                                                                                               | 945/30000 [1:37:06<48:49:30,  6.05s/it]





  3%|█████▋                                                                                                                                                                               | 950/30000 [1:37:36<48:42:57,  6.04s/it]





  3%|█████▊                                                                                                                                                                               | 955/30000 [1:38:06<48:25:03,  6.00s/it]





  3%|█████▊                                                                                                                                                                               | 960/30000 [1:38:35<47:43:40,  5.92s/it]
  3%|█████▊                                                                                                                                                                               | 960/30000 [1:38:35<47:43:40,  5.92s/it]Traceback (most recent call last):
  File "/home/jingbo/KVMemory/finetune_combine.py", line 96, in <module>
    main()
  File "/home/jingbo/KVMemory/finetune_combine.py", line 90, in main
    trainer.train()
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 1938, in train
    return inner_training_loop(
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 2279, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 3318, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/jingbo/KVMemory/src/training/trainer.py", line 332, in compute_loss
    outputs = self.model(input_ids=input_ids, attention_mask=attention_mask, labels = input_ids)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/peft/peft_model.py", line 1430, in forward
    return self.base_model(
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/peft/tuners/tuners_utils.py", line 179, in forward
    return self.model.forward(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 1139, in forward
    outputs = self.model(
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 942, in forward
    layer_outputs = decoder_layer(
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 693, in forward
    hidden_states = self.mlp(hidden_states)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 253, in forward
    down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 396, in forward
    return F.silu(input, inplace=self.inplace)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/functional.py", line 2102, in silu
    return torch._C._nn.silu(input)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 66.00 MiB. GPU
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/jingbo/KVMemory/finetune_combine.py", line 96, in <module>
[rank0]:     main()
[rank0]:   File "/home/jingbo/KVMemory/finetune_combine.py", line 90, in main
[rank0]:     trainer.train()
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 1938, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 2279, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/trainer.py", line 3318, in training_step
[rank0]:     loss = self.compute_loss(model, inputs)
[rank0]:   File "/home/jingbo/KVMemory/src/training/trainer.py", line 332, in compute_loss
[rank0]:     outputs = self.model(input_ids=input_ids, attention_mask=attention_mask, labels = input_ids)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/peft/peft_model.py", line 1430, in forward
[rank0]:     return self.base_model(
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/peft/tuners/tuners_utils.py", line 179, in forward
[rank0]:     return self.model.forward(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 1139, in forward
[rank0]:     outputs = self.model(
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 942, in forward
[rank0]:     layer_outputs = decoder_layer(
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 693, in forward
[rank0]:     hidden_states = self.mlp(hidden_states)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 253, in forward
[rank0]:     down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 396, in forward
[rank0]:     return F.silu(input, inplace=self.inplace)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/nn/functional.py", line 2102, in silu
[rank0]:     return torch._C._nn.silu(input)
[rank0]: torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 66.00 MiB. GPU