
  0%|                                                                  | 0/2 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
511
1076
1577
tensor(9.6508, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2048
tensor(9.7197, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2048
 50%|█████████████████████████████                             | 1/2 [00:05<00:05,  5.20s/it]
tensor(9.6520, device='cuda:0', grad_fn=<DivBackward0>)
511
1033
1534
tensor(9.0711, device='cuda:0', grad_fn=<DivBackward0>)
511
1482
1983
tensor(9.4420, device='cuda:0', grad_fn=<DivBackward0>)
511
761
1262
tensor(9.6780, device='cuda:0', grad_fn=<DivBackward0>)
511
1547
2048
tensor(9.5416, device='cuda:0', grad_fn=<DivBackward0>)
511
1547

100%|██████████████████████████████████████████████████████████| 2/2 [00:10<00:00,  5.02s/it]
tensor(9.5843, device='cuda:0', grad_fn=<DivBackward0>)
100%|██████████████████████████████████████████████████████████| 2/2 [01:08<00:00, 34.17s/it]
Traceback (most recent call last):
  File "/home/jingbo/KVMemory/finetune_connect.py", line 93, in <module>
    main()
  File "/home/jingbo/KVMemory/finetune_connect.py", line 87, in main
    torch.save(custom_model.trainable_key_caches, dump_dir + "/trainable_key_caches.pth")
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/serialization.py", line 840, in _save
    pickler.dump(obj)
TypeError: cannot pickle 'torch._C._distributed_c10d.ProcessGroup' object
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/jingbo/KVMemory/finetune_connect.py", line 93, in <module>
[rank0]:     main()
[rank0]:   File "/home/jingbo/KVMemory/finetune_connect.py", line 87, in main
[rank0]:     torch.save(custom_model.trainable_key_caches, dump_dir + "/trainable_key_caches.pth")
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/serialization.py", line 628, in save
[rank0]:     _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
[rank0]:   File "/home/jingbo/anaconda3/envs/unlearning/lib/python3.9/site-packages/torch/serialization.py", line 840, in _save
[rank0]:     pickler.dump(obj)
[rank0]: TypeError: cannot pickle 'torch._C._distributed_c10d.ProcessGroup' object